<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>记忆卡片游戏</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#EC4899',
                        accent: '#10B981',
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义样式 -->
    <style>
        .card {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: pointer;
            perspective: 1000px;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .card-back {
            background-color: #4F46E5;
            color: white;
            font-size: clamp(1.5rem, 5vw, 2rem);
        }
        
        .card-front {
            background-color: white;
            color: #EC4899;
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            transform: rotateY(180deg);
        }
        
        /* 延长卡片消失动画时间至1秒，使其更平滑 */
        .card.matched {
            opacity: 0;
            transform: scale(0) rotateY(180deg);
            pointer-events: none;
            transition: all 1s cubic-bezier(0.16, 1, 0.3, 1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-purple-50 min-h-screen p-4 font-sans flex flex-col">
    <div class="container mx-auto max-w-7xl flex-grow">
        <!-- 游戏标题 -->
        <header class="text-center mb-6">
            <h1 class="text-[clamp(1.8rem,6vw,2.5rem)] font-bold text-primary mb-2">记忆卡片</h1>
            <p class="text-gray-600">翻转卡片，找到所有配对！</p>
        </header>
        
        <!-- 游戏状态面板 -->
        <div class="bg-white rounded-xl shadow-lg p-3 md:p-5 mb-6 grid grid-cols-3 gap-2">
            <div class="text-center">
                <p class="text-gray-500 text-sm">步数</p>
                <p id="moves" class="text-xl font-bold text-primary">0</p>
            </div>
            <div class="text-center">
                <p class="text-gray-500 text-sm">用时</p>
                <p id="timer" class="text-xl font-bold text-primary">00:00</p>
            </div>
            <div class="text-center">
                <p class="text-gray-500 text-sm">已匹配</p>
                <p id="matches" class="text-xl font-bold text-accent">0/0</p>
            </div>
        </div>
        
        <!-- 控制按钮 -->
        <div class="flex flex-wrap justify-center gap-3 mb-6">
            <div class="relative">
                <label for="difficulty" class="block text-xs font-medium text-gray-700 mb-1">难度</label>
                <select id="difficulty" class="bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-6 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
                    <option value="easy">简单 (4×4)</option>
                    <option value="medium" selected>中等 (6×6)</option>
                    <option value="hard">困难 (8×8)</option>
                    <option value="very-hard">极难 (10×10)</option>
                </select>
            </div>
            <div class="pt-4">
                <button id="restart-btn" class="bg-primary hover:bg-primary/90 text-white font-medium py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 flex items-center text-sm">
                    <span class="mr-1">🔄</span> 重玩
                </button>
            </div>
        </div>
        
        <!-- 游戏卡片网格 -->
        <div id="game-board" class="grid grid-cols-6 sm:grid-cols-6 md:grid-cols-8 gap-2 sm:gap-3 mb-8">
            <!-- 卡片将通过JavaScript动态生成 -->
        </div>
        
        <!-- 游戏结束弹窗 -->
        <div id="game-over-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0" id="modal-content">
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/20 text-accent mb-4">
                        <span class="text-3xl">🏆</span>
                    </div>
                    <h2 class="text-xl font-bold mb-2">恭喜你！</h2>
                    <p class="text-gray-600 mb-4">你已完成所有配对</p>
                    
                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600">总步数：</span>
                            <span id="final-moves" class="font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">总用时：</span>
                            <span id="final-time" class="font-bold">00:00</span>
                        </div>
                    </div>
                    
                    <button id="play-again-btn" class="bg-primary hover:bg-primary/90 text-white font-medium py-2 px-6 rounded-lg transition-all duration-300 w-full">
                        再玩一次
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 底部信息 -->
    <footer class="bg-white/80 backdrop-blur-sm border-t border-gray-200 py-4 mt-8">
        <div class="container mx-auto px-4 text-center text-gray-600 text-sm">
            <p> 陈省安制作</p>
            <p>© 2025 记忆卡片游戏 | 当前版本1.0.0</p>
        </div>
    </footer>

    <script>
        // 游戏状态变量
        let gameState = {
            cards: [],
            flippedCards: [],
            matchedPairs: 0,
            totalPairs: 0,
            moves: 0,
            isProcessing: false,
            timer: null,
            seconds: 0
        };
        
        // 卡片图案，支持最大难度10×10=100张卡片（50对）
        const cardEmojis = [
            // 水果类
            '🍎', '🍐', '🍊', '🍋', '🍌', '🍉', '🍇', '🍓',
            '🍒', '🥭', '🥑', '🥝', '🍅', '🥥', '🍑', '🍍',
            
            // 蔬菜类
            '🥕', '🥒', '🥬', '🥦', '🍄', '🥔', '🧅', '🥑',
            
            // 食物类
            '🍞', '🍚', '🍝', '🍜', '🍕', '🍔', '🍟', '🌭',
            '🍿', '🍩', '🍪', '🎂', '🍰', '🍨', '🍦', '🍭',
            
            // 动物类
            '🐶', '🐱', '🐭', '🐹', '🐰', '🦊', '🐻', '🐼',
            '🐨', '🐯', '🦁', '🐮', '🐷', '🐸', '🐵', '🐔',
            
            // 其他类
            '🚗', '🚕', '🚙', '🚌', '✈️', '🚀', '☀️', '🌙'
        ];
        
        // DOM元素
        const gameBoard = document.getElementById('game-board');
        const movesDisplay = document.getElementById('moves');
        const timerDisplay = document.getElementById('timer');
        const matchesDisplay = document.getElementById('matches');
        const restartBtn = document.getElementById('restart-btn');
        const difficultySelect = document.getElementById('difficulty');
        const gameOverModal = document.getElementById('game-over-modal');
        const modalContent = document.getElementById('modal-content');
        const finalMovesDisplay = document.getElementById('final-moves');
        const finalTimeDisplay = document.getElementById('final-time');
        const playAgainBtn = document.getElementById('play-again-btn');
        
        // 初始化游戏
        function initGame() {
            // 根据难度设置卡片数量和网格
            let gridSize, cardCount;
            switch(difficultySelect.value) {
                case 'easy':
                    gridSize = 'grid-cols-4 sm:grid-cols-4 md:grid-cols-4';
                    cardCount = 16; // 4×4=16张卡片，8对
                    break;
                case 'hard':
                    gridSize = 'grid-cols-8 sm:grid-cols-8 md:grid-cols-8';
                    cardCount = 64; // 8×8=64张卡片，32对
                    break;
                case 'very-hard':
                    gridSize = 'grid-cols-10 sm:grid-cols-10 md:grid-cols-10';
                    cardCount = 100; // 10×10=100张卡片，50对
                    break;
                case 'medium':
                default:
                    gridSize = 'grid-cols-6 sm:grid-cols-6 md:grid-cols-6';
                    cardCount = 36; // 6×6=36张卡片，18对
                    break;
            }
            
            // 设置游戏板网格
            gameBoard.className = `grid ${gridSize} gap-2 sm:gap-3 mb-8`;
            
            // 重置游戏状态
            resetGameState();
            
            // 生成卡片
            generateCards(cardCount);
            
            // 更新显示
            updateDisplay();
        }
        
        // 重置游戏状态
        function resetGameState() {
            gameState.cards = [];
            gameState.flippedCards = [];
            gameState.matchedPairs = 0;
            gameState.moves = 0;
            gameState.isProcessing = false;
            
            // 停止计时器并重置
            if (gameState.timer) {
                clearInterval(gameState.timer);
                gameState.timer = null;
            }
            gameState.seconds = 0;
            
            // 清空游戏板
            gameBoard.innerHTML = '';
        }
        
        // 生成卡片
        function generateCards(cardCount) {
            // 确保卡片数量是偶数
            if (cardCount % 2 !== 0) cardCount++;
            
            gameState.totalPairs = cardCount / 2;
            
            // 检查是否有足够的图案，如果不够则复制补充
            let availableEmojis = [...cardEmojis];
            while (availableEmojis.length < gameState.totalPairs) {
                availableEmojis = [...availableEmojis, ...cardEmojis];
            }
            
            // 随机选择emoji并创建成对的卡片
            const selectedEmojis = availableEmojis
                .sort(() => 0.5 - Math.random())
                .slice(0, gameState.totalPairs);
                
            // 创建成对的卡片
            const cardPairs = [];
            selectedEmojis.forEach(emoji => {
                cardPairs.push({ emoji, matched: false });
                cardPairs.push({ emoji, matched: false });
            });
            
            // 随机排序卡片
            gameState.cards = cardPairs.sort(() => 0.5 - Math.random());
            
            // 创建卡片元素
            gameState.cards.forEach((card, index) => {
                const cardElement = createCardElement(index, card.emoji);
                gameBoard.appendChild(cardElement);
            });
        }
        
        // 创建卡片元素
        function createCardElement(index, emoji) {
            // 创建卡片容器
            const cardContainer = document.createElement('div');
            cardContainer.className = 'aspect-square transition-all duration-300'; // 确保卡片是正方形
            
            // 创建卡片
            const card = document.createElement('div');
            card.className = 'card h-full';
            card.dataset.index = index;
            
            // 卡片内部翻转容器
            const cardInner = document.createElement('div');
            cardInner.className = 'card-inner';
            
            // 卡片背面（问号）
            const cardBack = document.createElement('div');
            cardBack.className = 'card-back';
            cardBack.textContent = '?';
            
            // 卡片正面（emoji）
            const cardFront = document.createElement('div');
            cardFront.className = 'card-front';
            cardFront.textContent = emoji;
            
            // 组装卡片
            cardInner.appendChild(cardFront);
            cardInner.appendChild(cardBack);
            card.appendChild(cardInner);
            cardContainer.appendChild(card);
            
            // 添加点击事件
            card.addEventListener('click', () => flipCard(index));
            
            return cardContainer;
        }
        
        // 翻转卡片
        function flipCard(index) {
            // 验证条件
            if (gameState.isProcessing || 
                gameState.cards[index].matched || 
                gameState.flippedCards.includes(index)) {
                return;
            }
            
            // 开始计时器
            if (!gameState.timer) {
                startTimer();
            }
            
            // 翻转卡片
            const cardElement = document.querySelector(`.card[data-index="${index}"]`);
            cardElement.classList.add('flipped');
            
            // 记录翻转的卡片
            gameState.flippedCards.push(index);
            
            // 检查匹配
            if (gameState.flippedCards.length === 2) {
                gameState.moves++;
                updateDisplay();
                checkForMatch();
            }
        }
        
        // 检查匹配
        function checkForMatch() {
            gameState.isProcessing = true;
            
            const [index1, index2] = gameState.flippedCards;
            const card1 = gameState.cards[index1];
            const card2 = gameState.cards[index2];
            
            if (card1.emoji === card2.emoji) {
                // 匹配成功 - 卡片消失效果
                card1.matched = true;
                card2.matched = true;
                gameState.matchedPairs++;
                
                // 添加匹配样式 - 卡片消失（动画时间已延长）
                setTimeout(() => {
                    const cardElement1 = document.querySelector(`.card[data-index="${index1}"]`);
                    const cardElement2 = document.querySelector(`.card[data-index="${index2}"]`);
                    cardElement1.classList.add('matched');
                    cardElement2.classList.add('matched');
                    
                    gameState.flippedCards = [];
                    gameState.isProcessing = false;
                    
                    updateDisplay();
                    
                    // 检查游戏结束
                    if (gameState.matchedPairs === gameState.totalPairs) {
                        endGame();
                    }
                }, 500);
            } else {
                // 匹配失败，翻回卡片
                setTimeout(() => {
                    const cardElement1 = document.querySelector(`.card[data-index="${index1}"]`);
                    const cardElement2 = document.querySelector(`.card[data-index="${index2}"]`);
                    cardElement1.classList.remove('flipped');
                    cardElement2.classList.remove('flipped');
                    
                    gameState.flippedCards = [];
                    gameState.isProcessing = false;
                }, 1000);
            }
        }
        
        // 计时器功能
        function startTimer() {
            gameState.timer = setInterval(() => {
                gameState.seconds++;
                updateTimerDisplay();
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.seconds / 60);
            const seconds = gameState.seconds % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // 更新显示
        function updateDisplay() {
            movesDisplay.textContent = gameState.moves;
            matchesDisplay.textContent = `${gameState.matchedPairs}/${gameState.totalPairs}`;
            updateTimerDisplay();
        }
        
        // 游戏结束
        function endGame() {
            clearInterval(gameState.timer);
            
            finalMovesDisplay.textContent = gameState.moves;
            const minutes = Math.floor(gameState.seconds / 60);
            const seconds = gameState.seconds % 60;
            finalTimeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            setTimeout(() => {
                gameOverModal.classList.remove('hidden');
                setTimeout(() => {
                    modalContent.classList.remove('scale-95', 'opacity-0');
                    modalContent.classList.add('scale-100', 'opacity-100');
                }, 10);
            }, 500);
        }
        
        // 事件监听
        restartBtn.addEventListener('click', initGame);
        difficultySelect.addEventListener('change', initGame);
        playAgainBtn.addEventListener('click', () => {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                gameOverModal.classList.add('hidden');
                initGame();
            }, 300);
        });
        
        // 初始化游戏
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
    